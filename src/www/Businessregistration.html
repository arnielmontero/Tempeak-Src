<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Bootstrap Example</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
			
		<link rel="stylesheet" type="text/css" href="./css/fontawesome.min.css" />
		<link rel="stylesheet" type="text/css" href="./css/index.css" />
		<link rel="stylesheet" type="text/css" href="./css/bootstrap.min.css" />
	</head>

	<body>       
		<nav style="padding: 10px 10px 10px 10px" class="navbar navbar-expand-lg navbar-dark bg-primary">
			<a  class="navbar-brand" href="#">  </a>  
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="text-align:center collapse navbar-collapse" id="navbarColor02">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item active">
						<a class="nav-link" href="./index.html">Home<span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="./Search.html">Search</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="./pricing.html">Pricing</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" id="logout" href="#">Logout</a>
					</li>
				</ul>
			</div>
		</nav>    
		<div class="container">
			<div class="container">
				<h2 style="margin-top: 30px" class="text-warning">Registration Requirement</h2>
				<span>Please fill-out the additional information.</span>
			</div>
		</div>
		<div class="container">
			<form>
				<div style="margin-top: 30px"  class="form-group col-md-4">
					<select id="state" class="form-control" required>
						<small  class="form-text text-muted">Choose from "Contractor or Business Owner</small>
						<option value="">State</option>
						<option value="AL">Alabama</option>
						<option value="AK">Alaska</option>
						<option value="AZ">Arizona</option>
						<option value="AR">Arkansas</option>
						<option value="CA">California</option>
						<option value="CO">Colorado</option>
						<option value="CT">Connecticut</option>
						<option value="DE">Delaware</option>
						<option value="DC">District of Columbia</option>
						<option value="FL">Florida</option>
						<option value="GA">Georgia</option>
						<option value="HI">Hawaii</option>
						<option value="ID">Idaho</option>
						<option value="IL">Illinois</option>
						<option value="IN">Indiana</option>
						<option value="IA">Iowa</option>
						<option value="KS">Kansas</option>
						<option value="KY">Kentucky</option>
						<option value="LA">Louisiana</option>
						<option value="ME">Maine</option>
						<option value="MD">Maryland</option>
						<option value="MA">Massachusetts</option>
						<option value="MI">Michigan</option>
						<option value="MN">Minnesota</option>
						<option value="MS">Mississippi</option>
						<option value="MO">Missouri</option>
						<option value="MT">Montana</option>
						<option value="NE">Nebraska</option>
						<option value="NV">Nevada</option>
						<option value="NH">New Hampshire</option>
						<option value="NJ">New Jersey</option>
						<option value="NM">New Mexico</option>
						<option value="NY">New York</option>
						<option value="NC">North Carolina</option>
						<option value="ND">North Dakota</option>
						<option value="OH">Ohio</option>
						<option value="OK">Oklahoma</option>
						<option value="OR">Oregon</option>
						<option value="PA">Pennsylvania</option>
						<option value="RI">Rhode Island</option>
						<option value="SC">South Carolina</option>
						<option value="SD">South Dakota</option>
						<option value="TN">Tennessee</option>
						<option value="TX">Texas</option>
						<option value="UT">Utah</option>
						<option value="VT">Vermont</option>
						<option value="VA">Virginia</option>
						<option value="WA">Washington</option>
						<option value="WV">West Virginia</option>
						<option value="WI">Wisconsin</option>
						<option value="WY">Wyoming</option>
										  
					</select>
				</div>

				<div  class="form-group col-md-4">
					<select id="city" name="city" class="form-control" required>
						<small class="form-text text-muted">Choose from "Contractor or Business Owner</small>
						<option value="">City</option>
						
					</select>
				</div>							

				<div class="form-group col-md-4">

					<div class="form-group">
						<input type="text" id='address' class="form-control" placeholder="Address" required>
					</div>


					<div class="form-group">
						<input type="text" id='zip' class="form-control" placeholder="Zip code" required>
					</div>


					<div class="form-group">
						<input type="text" id='phone' class="form-control" placeholder="Phone" required>
					</div>

					<div class="form-group">
						<input type="text" id='business' class="form-control" placeholder="Business name" required>
					</div>

					<div class="form-group">
						<input type="text" id='website' class="form-control" placeholder="Website" required>
					</div>

					<!-- <div class="form-group"> -->
						<!-- <div class="input-group mb-3"> -->
							<!-- <div class="custom-file"> -->
							<!-- <input type="file" class="custom-file-input logo" id="logo" required> -->
							<!-- <label class="custom-file-label" for="inputGroupFile02">Upload logo</label> -->
							<!-- </div> -->

						<!-- </div> -->
					<!-- </div> -->

					<div class="form-group">
						<div class="input-group mb-3">
							<div class="custom-file">
							 <input type="text" id='licensenum' class="form-control" placeholder="License Number" required>
							</div>
						</div>
					</div>

					<div class="form-group">
						<div class="input-group mb-3">
							<div class="custom-file">
								 <select id="subscription" class="form-control">
									<small  class="form-text text-muted">Choose from "Contractor or Business Owner</small>
									
									<option value='bo_three_month_one'>3 months + 1 month trial
								($299,97 usd)</option>
								<option value='bo_six_month_one'> 6 months + 1 month trial
								($539,94 usd)</option>
									<option value='bo_one_year_one'> 12 months + 1 month trial
								($959,88 usd)</option>
									</select>
							</div>
						 </div>
					</div>		
				</div>
				
				<br>

				<!-- <a href="./Registration3.html" class="btn btn-warning btn-prima btn-block" role="button">Register</a> -->
				<button type='submit' id='bregister'  class="btn btn-warning btn-prima btn-block" role="button">Register</button>
				<br>
				<p style="margin-top:20px">Need Help? <a href="#">FAQ Here!</a></p>
				<p><a href="./PrivacyPolicy.html">Privacy Policy</a> and <a href="./termsofuse.html">Terms of Use</a> </p>
			</form>	
		</div>
		<script type="text/javascript" src="cordova.js"></script>
		<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="js/bootstrap.min.js"></script>
		<script type="text/javascript" src="js/index.js"></script>
		<script type="text/javascript" src="http://tp.loyaltypower7.com/js/url-ver.js"></script>	
		<script type="text/javascript" src="js/validation-script.js"></script>
		<script type="text/javascript" src="js/logout.js"></script>
		<script>
		
			<!-- $(document).ready(function() { -->
				<!-- window.history.pushState(null, "", window.location.href);         -->
				<!-- window.onpopstate = function() { -->
					<!-- window.history.pushState(null, "", window.location.href); -->
			<!-- }; -->
		
			$(document).ready(function (){
					window.history.pushState(null, "", window.location.href);  
						window.onpopstate = function() {
							window.history.pushState(null, "", window.location.href);
					};
								
					var link = window.location.href; 
					var url = new URL(link);
					var keyr = url.searchParams.get("key");
					
					if(keyr !== ""){
						sessionStorage.setItem('key', keyr);
					}					
					var key = sessionStorage.getItem('key');
			
				$('#bregister').click(function(e){
		
					var state = $('#state').val(),
						city  = $('#city').val(),
						address  = $('#address').val(),
						zip  = $('#zip').val(),
						phone  = $('#phone').val(),
						business  = $('#business').val(),
						website  = $('#website').val(),				
						licensenum  = $('#licensenum').val(),
						subscription  = $('#subscription').val();

					if(state !=="" && city !=="" && 	address !=="" && 	zip !=="" && phone !=="" && business !=="" && website !=="" && licensenum !== ""){
	
						var form_data = new FormData();
						form_data.append('state', state);
						form_data.append('city', city);
						form_data.append('address', address);
						form_data.append('zip', zip);
						form_data.append('phone', phone);
						form_data.append('business', business);
						form_data.append('website', website);
						form_data.append('licensenum', licensenum);
						form_data.append('subscription', subscription);
						form_data.append('key', key);

						$.ajax({
								url: hosturl +'bregistrationcon', // point to server-side PHP script 
								dataType: 'text',  // what to expect back from the PHP script, if anything
								cache: false,
								contentType: false,
								processData: false,
								data: form_data,                         
								type: 'post',
								success: function(php_script_response){
									if(php_script_response){
										setTimeout(function(){											
											window.location.href="./Profile2.html?key="+key;
										}, 0);			
									}else{
										alert('Something went wrong.. Please review entry.');
									}
								}
							 });			
						e.preventDefault();
					}
					 

				});

			});
			
				
		
		
				
//state	 get city
 $("#state").change(function(){

        var city = $("#city");

        $.ajax({
            url: getcityzipurl +'user/getCity/' + this.value,
            context: document.body,
            type: "GET",
            success: function(response){

                city.html("");
                city.append("<option value=''>City</option>");

                if(response.length > 0) {
                    $.each(response, function (i, value) {
                        city.append("<option value='"+value+"'>"+value+"</option>");
                    });
                }
            },
            error:function(msg){}
        })
    });	
		
//city get zip code
$("#city").change(function () {

        if($("#city").val() == '') {
            $("#zip_code").val('');
            return;
        }

        console.log($("#state").val() + ',' + $("#city").val());

        var params = "?address=" + $("#state").val() + ',' + $("#city").val();
        var key = "&key=AIzaSyAeRs5ly0e10iR1k-PqEtfR7IsyinJ15V0";
        var uri = "https://maps.googleapis.com/maps/api/geocode/json";


        $.ajax({
            url: uri + params + key,
            dataType: "json",
            success: function (data) {

                $("#zip").val('');

                $.each(data.results[0].address_components, function (key, value) {
                    if(value.types.indexOf("postal_code") > -1) {
                        $("#zip").val(value.long_name);
                    }
                })
            },
            after: function (e) {
                console.log(e);
            },

            error: function (e) {
                console.log(e);
            }
        });
    });	   	
			
			
			
		</script>
	
	</body>
</html>         